<!doctype html><html lang=zh class=html><head><meta charset=UTF-8><meta name=viewport content="width=device-width,initial-scale=1"><title>資料品質與治理全攻略：Data Contract、Schema Evolution、Lineage、驗證與監控 - Yu's Portfolio & Learning Hub</title><meta name=description content="資料品質與治理是數據工程的核心，直接影響下游分析、AI 與業務決策的可靠性。本章將深入 Data Contract、Schema Evolution、資料驗證（Great Expectations、Deequ）、Data Lineage（OpenLineage、Marquez）、監控與自動化治理，結合理論、實作、面試熱點與常見誤區，幫助你打造高信賴的數據平台。
Data Contract / Schema Evolution Data Contract 明確定義資料格式、欄位型別、約束、品質標準 生產者/消費者協議，防止 breaking change 支援自動驗證、Schema 驗證、資料 SLA Schema Evolution 支援資料格式隨需求變更（如新增欄位、型別變更） 格式：Avro、Parquet、ORC 皆支援 Schema 演進 策略：Backward/Forward/Full Compatibility # Avro Schema Evolution 範例 import fastavro from fastavro.schema import load_schema old_schema = load_schema('user_v1.avsc') new_schema = load_schema('user_v2.avsc') # fastavro 會自動處理兼容性 Great Expectations / Deequ 規則撰寫 Great Expectations Python 生態，支援資料驗證、型別檢查、缺失值、唯一性、分布檢查 可自動產生驗證報告，整合 Airflow、dbt import great_expectations as ge df = ge.from_pandas(your_dataframe) df.expect_column_values_to_not_be_null('user_id') df.expect_column_values_to_be_unique('order_id') Deequ Scala/Java 生態，適合 Spark 大數據驗證 支援自動化規則、分布檢查、異常偵測 Data Lineage：OpenLineage & Marquez Data Lineage 追蹤資料從來源到消費的全流程，支援審計、回溯、影響分析 關鍵於資料治理、法規遵循、異常排查 OpenLineage 開放標準，支援多種 Orchestrator（Airflow、Spark、dbt） 可視化資料流、任務依賴、欄位級 lineage Marquez 開源 Data Lineage 平台，整合 OpenLineage 支援 API、UI、事件追蹤、審計 監控與自動化治理 結合 Orchestrator（Airflow、Dagster）自動化資料驗證 設計資料 SLA、異常告警、品質報表 定期驗證 Schema、Lineage，防止資料腐敗 理論直覺、應用場景與常見誤區 應用場景 金融、醫療、電商、AI 平台、法規遵循、資料治理專案 常見誤區 無 Data Contract，資料格式頻繁變動 Schema Evolution 未設兼容策略，導致下游崩潰 資料驗證僅做一次，未持續監控 Lineage 未落地，異常難追蹤 面試熱點與經典問題 主題 常見問題 Data Contract 作用與設計要點？ Schema Evolution 如何兼容？ Great Expectations/Deequ 規則撰寫與自動化？ Data Lineage 如何落地與應用？ 監控 如何設計資料品質告警？ 使用注意事項 Data Contract 需雙方協議並自動驗證 Schema Evolution 建議設兼容等級與審核流程 資料驗證與 Lineage 建議自動化並定期審查 延伸閱讀與資源 Great Expectations 官方文件 Deequ 官方文件 OpenLineage 官方文件 Marquez 官方文件 Schema Evolution in Avro/Parquet 經典面試題與解法提示 Data Contract 如何設計與落地？ Schema Evolution 兼容策略有哪些？ Great Expectations/Deequ 如何自動化驗證？ Data Lineage 有哪些應用場景？ 監控與告警如何設計？ Lineage 與法規遵循的關係？ Schema Evolution 失敗會有什麼後果？ 如何用 Python 實作資料驗證？ Lineage 平台如何整合 Orchestrator？ 資料品質治理常見挑戰與解法？ 結語 資料品質與治理是數據平台的生命線。熟悉 Data Contract、Schema Evolution、Lineage、驗證與監控，能讓你打造高信賴、可追溯的數據平台。下一章將進入版本控管與測試，敬請期待！
"><meta property="og:title" content="資料品質與治理全攻略：Data Contract、Schema Evolution、Lineage、驗證與監控"><meta property="og:description" content="資料品質與治理是數據工程的核心，直接影響下游分析、AI 與業務決策的可靠性。本章將深入 Data Contract、Schema Evolution、資料驗證（Great Expectations、Deequ）、Data Lineage（OpenLineage、Marquez）、監控與自動化治理，結合理論、實作、面試熱點與常見誤區，幫助你打造高信賴的數據平台。
Data Contract / Schema Evolution Data Contract 明確定義資料格式、欄位型別、約束、品質標準 生產者/消費者協議，防止 breaking change 支援自動驗證、Schema 驗證、資料 SLA Schema Evolution 支援資料格式隨需求變更（如新增欄位、型別變更） 格式：Avro、Parquet、ORC 皆支援 Schema 演進 策略：Backward/Forward/Full Compatibility # Avro Schema Evolution 範例 import fastavro from fastavro.schema import load_schema old_schema = load_schema('user_v1.avsc') new_schema = load_schema('user_v2.avsc') # fastavro 會自動處理兼容性 Great Expectations / Deequ 規則撰寫 Great Expectations Python 生態，支援資料驗證、型別檢查、缺失值、唯一性、分布檢查 可自動產生驗證報告，整合 Airflow、dbt import great_expectations as ge df = ge.from_pandas(your_dataframe) df.expect_column_values_to_not_be_null('user_id') df.expect_column_values_to_be_unique('order_id') Deequ Scala/Java 生態，適合 Spark 大數據驗證 支援自動化規則、分布檢查、異常偵測 Data Lineage：OpenLineage & Marquez Data Lineage 追蹤資料從來源到消費的全流程，支援審計、回溯、影響分析 關鍵於資料治理、法規遵循、異常排查 OpenLineage 開放標準，支援多種 Orchestrator（Airflow、Spark、dbt） 可視化資料流、任務依賴、欄位級 lineage Marquez 開源 Data Lineage 平台，整合 OpenLineage 支援 API、UI、事件追蹤、審計 監控與自動化治理 結合 Orchestrator（Airflow、Dagster）自動化資料驗證 設計資料 SLA、異常告警、品質報表 定期驗證 Schema、Lineage，防止資料腐敗 理論直覺、應用場景與常見誤區 應用場景 金融、醫療、電商、AI 平台、法規遵循、資料治理專案 常見誤區 無 Data Contract，資料格式頻繁變動 Schema Evolution 未設兼容策略，導致下游崩潰 資料驗證僅做一次，未持續監控 Lineage 未落地，異常難追蹤 面試熱點與經典問題 主題 常見問題 Data Contract 作用與設計要點？ Schema Evolution 如何兼容？ Great Expectations/Deequ 規則撰寫與自動化？ Data Lineage 如何落地與應用？ 監控 如何設計資料品質告警？ 使用注意事項 Data Contract 需雙方協議並自動驗證 Schema Evolution 建議設兼容等級與審核流程 資料驗證與 Lineage 建議自動化並定期審查 延伸閱讀與資源 Great Expectations 官方文件 Deequ 官方文件 OpenLineage 官方文件 Marquez 官方文件 Schema Evolution in Avro/Parquet 經典面試題與解法提示 Data Contract 如何設計與落地？ Schema Evolution 兼容策略有哪些？ Great Expectations/Deequ 如何自動化驗證？ Data Lineage 有哪些應用場景？ 監控與告警如何設計？ Lineage 與法規遵循的關係？ Schema Evolution 失敗會有什麼後果？ 如何用 Python 實作資料驗證？ Lineage 平台如何整合 Orchestrator？ 資料品質治理常見挑戰與解法？ 結語 資料品質與治理是數據平台的生命線。熟悉 Data Contract、Schema Evolution、Lineage、驗證與監控，能讓你打造高信賴、可追溯的數據平台。下一章將進入版本控管與測試，敬請期待！
"><meta property="og:url" content="https://yu-codes.github.io/portfolio/zh/articles/others/data-engineering/data-quality-governance/"><link rel=canonical href=https://yu-codes.github.io/portfolio/zh/articles/others/data-engineering/data-quality-governance/><link rel=stylesheet href=https://yu-codes.github.io/portfolio/css/main.css></head><body class=body><div class=container><aside class=sidebar><div class=sidebar-header><h1 class=name>Yu</h1><p class=tagline>Developer, dreamer, debugger.</p></div><nav class=sidebar-nav><a href=https://yu-codes.github.io/portfolio/zh/ class=nav-item><svg class="icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M3 9l9-7 9 7v11a2 2 0 01-2 2H5a2 2 0 01-2-2z"/><polyline points="9 22 9 12 15 12 15 22"/></svg>
<span>首頁</span>
</a><a href=https://yu-codes.github.io/portfolio/zh/articles/ class="nav-item active"><svg class="icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M4 19.5A2.5 2.5.0 016.5 17H20"/><path d="M6.5 2H20v20H6.5A2.5 2.5.0 014 19.5v-15A2.5 2.5.0 016.5 2z"/></svg>
<span>文章</span>
</a><a href=https://yu-codes.github.io/portfolio/zh/resume/ class=nav-item><svg class="icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M14 2H6A2 2 0 004 4v16a2 2 0 002 2h12a2 2 0 002-2V8z"/><polyline points="14 2 14 8 20 8"/><line x1="12" y1="11" x2="12" y2="17"/><line x1="9" y1="14" x2="15" y2="14"/></svg>
<span>履歷</span>
</a><a href=https://yu-codes.github.io/portfolio/zh/projects/ class=nav-item><svg class="icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="3" y="3" width="8" height="8"/><rect x="13" y="3" width="8" height="8"/><rect x="3" y="13" width="8" height="8"/><rect x="13" y="13" width="8" height="8"/></svg>
<span>專案</span>
</a><a href=https://yu-codes.github.io/portfolio/zh/archives/ class=nav-item><svg class="icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="3" y="4" width="18" height="18" rx="2" ry="2"/><line x1="16" y1="2" x2="16" y2="6"/><line x1="8" y1="2" x2="8" y2="6"/><line x1="3" y1="10" x2="21" y2="10"/></svg>
<span>歸檔</span></a></nav><div class=sidebar-footer><div class=controls><button class="control-btn theme-toggle" title=切換主題（淺色/深色） aria-label="Toggle theme">
<svg class="icon-sun" viewBox="0 0 24 24" fill="none"><circle cx="12" cy="12" r="9" stroke="currentColor" stroke-width="1.5" fill="none"/><path d="M12 3a9 9 0 010 18" fill="currentColor" opacity=".9"/><path d="M12 3a9 9 0 000 18" fill="currentColor" opacity=".25"/></svg>
<svg class="icon-moon" viewBox="0 0 24 24" fill="none"><circle cx="12" cy="12" r="9" stroke="currentColor" stroke-width="1.5" fill="none"/><path d="M12 3a9 9 0 000 18" fill="currentColor" opacity=".9"/><path d="M12 3a9 9 0 010 18" fill="currentColor" opacity=".25"/></svg>
</button>
<button class="control-btn lang-toggle" title=切換語言 aria-label="Toggle language">
<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="12" r="10"/><path d="M2 12h20"/><path d="M12 2a15.3 15.3.0 014 10 15.3 15.3.0 01-4 10A15.3 15.3.0 018 12a15.3 15.3.0 014-10z"/></svg></button></div><div class=social-links><a href=https://github.com/yu-codes target=_blank rel="noopener noreferrer" class=social-link title=GitHub><svg viewBox="0 0 24 24" fill="currentColor"><path d="M12 0C5.374.0.0 5.373.0 12c0 5.302 3.438 9.8 8.207 11.387.599.111.793-.261.793-.577v-2.234c-3.338.726-4.033-1.416-4.033-1.416-.546-1.387-1.333-1.756-1.333-1.756-1.089-.745.083-.729.083-.729 1.205.084 1.839 1.237 1.839 1.237 1.07 1.834 2.807 1.304 3.492.997.107-.775.418-1.305.762-1.604-2.665-.305-5.467-1.334-5.467-5.931.0-1.311.469-2.381 1.236-3.221-.124-.303-.535-1.524.117-3.176.0.0 1.008-.322 3.301 1.23.957-.266 1.983-.399 3.003-.404 1.02.005 2.047.138 3.006.404 2.291-1.552 3.297-1.23 3.297-1.23.653 1.653.242 2.874.118 3.176.77.84 1.235 1.911 1.235 3.221.0 4.609-2.807 5.624-5.479 5.921.43.372.823 1.102.823 2.222v3.293c0 .319.192.694.801.576C20.566 21.797 24 17.3 24 12c0-6.627-5.373-12-12-12z"/></svg>
</a><a href=mailto:dylan.jhou1120@gmail.com class=social-link title=Email><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M4 4h16c1.1.0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1.0-2-.9-2-2V6c0-1.1.9-2 2-2z"/><polyline points="22,6 12,13 2,6"/></svg></a></div></div></aside><div class=main-content><div class=topbar><div class=breadcrumb><a href=https://yu-codes.github.io/portfolio/zh/>首頁</a>
<span class=separator>&#8250;</span>
<a href=https://yu-codes.github.io/portfolio/zh/articles/>文章</a>
<span class=separator>&#8250;</span>
<a href=https://yu-codes.github.io/portfolio/zh/articles/others/>其他</a><span class=separator>&#8250;</span>
<a href=https://yu-codes.github.io/portfolio/zh/articles/others/data-engineering/>資料工程</a><span class=separator>&#8250;</span>
<span>資料品質與治理全攻略：Data Contract、Schema Evolution、Lineage、驗證與監控</span></div></div><main class=content-area><article class=article-content><header class=article-header><h1>資料品質與治理全攻略：Data Contract、Schema Evolution、Lineage、驗證與監控</h1><div class=article-meta><span class=article-author><svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M20 21v-2a4 4 0 00-4-4H8a4 4 0 00-4 4v2"/><circle cx="12" cy="7" r="4"/></svg>
Yu-Han Jhou
</span><span class=article-updated><svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="10"/><polyline points="12 6 12 12 16 14"/></svg>
最後更新: 2025-11-30</span></div></header><div class=article-body><p>資料品質與治理是數據工程的核心，直接影響下游分析、AI 與業務決策的可靠性。本章將深入 Data Contract、Schema Evolution、資料驗證（Great Expectations、Deequ）、Data Lineage（OpenLineage、Marquez）、監控與自動化治理，結合理論、實作、面試熱點與常見誤區，幫助你打造高信賴的數據平台。</p><hr><nav class=article-toc><span class=toc-title>目錄</span><nav id=TableOfContents><ul><li><a href=#data-contract--schema-evolution>Data Contract / Schema Evolution</a><ul><li><a href=#data-contract>Data Contract</a></li><li><a href=#schema-evolution>Schema Evolution</a></li></ul></li><li><a href=#great-expectations--deequ-規則撰寫>Great Expectations / Deequ 規則撰寫</a><ul><li><a href=#great-expectations>Great Expectations</a></li><li><a href=#deequ>Deequ</a></li></ul></li><li><a href=#data-lineageopenlineage--marquez>Data Lineage：OpenLineage & Marquez</a><ul><li><a href=#data-lineage>Data Lineage</a></li><li><a href=#openlineage>OpenLineage</a></li><li><a href=#marquez>Marquez</a></li></ul></li><li><a href=#監控與自動化治理>監控與自動化治理</a></li><li><a href=#理論直覺應用場景與常見誤區>理論直覺、應用場景與常見誤區</a><ul><li><a href=#應用場景>應用場景</a></li><li><a href=#常見誤區>常見誤區</a></li></ul></li><li><a href=#面試熱點與經典問題>面試熱點與經典問題</a></li><li><a href=#使用注意事項>使用注意事項</a></li><li><a href=#延伸閱讀與資源>延伸閱讀與資源</a></li><li><a href=#經典面試題與解法提示>經典面試題與解法提示</a></li><li><a href=#結語>結語</a></li></ul></nav></nav><h2 id=data-contract--schema-evolution>Data Contract / Schema Evolution</h2><h3 id=data-contract>Data Contract</h3><ul><li>明確定義資料格式、欄位型別、約束、品質標準</li><li>生產者/消費者協議，防止 breaking change</li><li>支援自動驗證、Schema 驗證、資料 SLA</li></ul><h3 id=schema-evolution>Schema Evolution</h3><ul><li>支援資料格式隨需求變更（如新增欄位、型別變更）</li><li>格式：Avro、Parquet、ORC 皆支援 Schema 演進</li><li>策略：Backward/Forward/Full Compatibility</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#75715e># Avro Schema Evolution 範例</span>
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> fastavro
</span></span><span style=display:flex><span><span style=color:#f92672>from</span> fastavro.schema <span style=color:#f92672>import</span> load_schema
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>old_schema <span style=color:#f92672>=</span> load_schema(<span style=color:#e6db74>&#39;user_v1.avsc&#39;</span>)
</span></span><span style=display:flex><span>new_schema <span style=color:#f92672>=</span> load_schema(<span style=color:#e6db74>&#39;user_v2.avsc&#39;</span>)
</span></span><span style=display:flex><span><span style=color:#75715e># fastavro 會自動處理兼容性</span>
</span></span></code></pre></div><hr><h2 id=great-expectations--deequ-規則撰寫>Great Expectations / Deequ 規則撰寫</h2><h3 id=great-expectations>Great Expectations</h3><ul><li>Python 生態，支援資料驗證、型別檢查、缺失值、唯一性、分布檢查</li><li>可自動產生驗證報告，整合 Airflow、dbt</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#f92672>import</span> great_expectations <span style=color:#66d9ef>as</span> ge
</span></span><span style=display:flex><span>df <span style=color:#f92672>=</span> ge<span style=color:#f92672>.</span>from_pandas(your_dataframe)
</span></span><span style=display:flex><span>df<span style=color:#f92672>.</span>expect_column_values_to_not_be_null(<span style=color:#e6db74>&#39;user_id&#39;</span>)
</span></span><span style=display:flex><span>df<span style=color:#f92672>.</span>expect_column_values_to_be_unique(<span style=color:#e6db74>&#39;order_id&#39;</span>)
</span></span></code></pre></div><h3 id=deequ>Deequ</h3><ul><li>Scala/Java 生態，適合 Spark 大數據驗證</li><li>支援自動化規則、分布檢查、異常偵測</li></ul><hr><h2 id=data-lineageopenlineage--marquez>Data Lineage：OpenLineage & Marquez</h2><h3 id=data-lineage>Data Lineage</h3><ul><li>追蹤資料從來源到消費的全流程，支援審計、回溯、影響分析</li><li>關鍵於資料治理、法規遵循、異常排查</li></ul><h3 id=openlineage>OpenLineage</h3><ul><li>開放標準，支援多種 Orchestrator（Airflow、Spark、dbt）</li><li>可視化資料流、任務依賴、欄位級 lineage</li></ul><h3 id=marquez>Marquez</h3><ul><li>開源 Data Lineage 平台，整合 OpenLineage</li><li>支援 API、UI、事件追蹤、審計</li></ul><hr><h2 id=監控與自動化治理>監控與自動化治理</h2><ul><li>結合 Orchestrator（Airflow、Dagster）自動化資料驗證</li><li>設計資料 SLA、異常告警、品質報表</li><li>定期驗證 Schema、Lineage，防止資料腐敗</li></ul><hr><h2 id=理論直覺應用場景與常見誤區>理論直覺、應用場景與常見誤區</h2><h3 id=應用場景>應用場景</h3><ul><li>金融、醫療、電商、AI 平台、法規遵循、資料治理專案</li></ul><h3 id=常見誤區>常見誤區</h3><ul><li>無 Data Contract，資料格式頻繁變動</li><li>Schema Evolution 未設兼容策略，導致下游崩潰</li><li>資料驗證僅做一次，未持續監控</li><li>Lineage 未落地，異常難追蹤</li></ul><hr><h2 id=面試熱點與經典問題>面試熱點與經典問題</h2><table><thead><tr><th>主題</th><th>常見問題</th></tr></thead><tbody><tr><td>Data Contract</td><td>作用與設計要點？</td></tr><tr><td>Schema Evolution</td><td>如何兼容？</td></tr><tr><td>Great Expectations/Deequ</td><td>規則撰寫與自動化？</td></tr><tr><td>Data Lineage</td><td>如何落地與應用？</td></tr><tr><td>監控</td><td>如何設計資料品質告警？</td></tr></tbody></table><hr><h2 id=使用注意事項>使用注意事項</h2><ul><li>Data Contract 需雙方協議並自動驗證</li><li>Schema Evolution 建議設兼容等級與審核流程</li><li>資料驗證與 Lineage 建議自動化並定期審查</li></ul><hr><h2 id=延伸閱讀與資源>延伸閱讀與資源</h2><ul><li><a href=https://docs.greatexpectations.io/docs/>Great Expectations 官方文件</a></li><li><a href=https://deequ.github.io/deequ/>Deequ 官方文件</a></li><li><a href=https://openlineage.io/docs/>OpenLineage 官方文件</a></li><li><a href=https://marquezproject.github.io/marquez/>Marquez 官方文件</a></li><li><a href=https://docs.confluent.io/platform/current/schema-registry/avro.html#schema-evolution>Schema Evolution in Avro/Parquet</a></li></ul><hr><h2 id=經典面試題與解法提示>經典面試題與解法提示</h2><ol><li>Data Contract 如何設計與落地？</li><li>Schema Evolution 兼容策略有哪些？</li><li>Great Expectations/Deequ 如何自動化驗證？</li><li>Data Lineage 有哪些應用場景？</li><li>監控與告警如何設計？</li><li>Lineage 與法規遵循的關係？</li><li>Schema Evolution 失敗會有什麼後果？</li><li>如何用 Python 實作資料驗證？</li><li>Lineage 平台如何整合 Orchestrator？</li><li>資料品質治理常見挑戰與解法？</li></ol><hr><h2 id=結語>結語</h2><p>資料品質與治理是數據平台的生命線。熟悉 Data Contract、Schema Evolution、Lineage、驗證與監控，能讓你打造高信賴、可追溯的數據平台。下一章將進入版本控管與測試，敬請期待！</p></div><div class=article-tags><div class=tags><span class=tag>Data Contract</span>
<span class=tag>Schema Evolution</span>
<span class=tag>Data Lineage</span>
<span class=tag>Great Expectations</span>
<span class=tag>Deequ</span>
<span class=tag>OpenLineage</span>
<span class=tag>Marquez</span></div></div><footer class=article-footer><a href=/portfolio/zh/articles/others/data-engineering/ class=back-link>← 返回 資料工程</a></footer></article></main><footer class=site-footer><p>&copy; 2026 YuHan Jhou. All rights reserved.</p></footer></div></div><script src=https://yu-codes.github.io/portfolio/js/theme.js defer></script><script src=https://yu-codes.github.io/portfolio/js/roadmap.js defer></script><script src=https://yu-codes.github.io/portfolio/js/parallax.js defer></script><script src=https://yu-codes.github.io/portfolio/js/page-transition.js defer></script></body></html>